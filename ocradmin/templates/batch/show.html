{% extends "standard.html" %}

{% block title %} OCRopodium - {{batch.name}} {% endblock %}

{% block headerscript %}
	<script type='application/javascript' src='/static/js/jquery/jquery.mousewheel.min.js'></script>
	<script type='application/javascript' src='/static/js/batch/show.js'></script>
	<script type='application/javascript' src='/static/js/multi_filter_list.js'></script>
	<script type='application/javascript' src='/static/js/batch_widget.js'></script>
	<script type='application/javascript' src='/static/js/batch_widget2.js'></script>
	<script type='application/javascript' src='/static/js/export_widget.js'></script>
	<script type='application/javascript' src='/static/js/comparison_widget.js'></script>
	<script type='application/javascript' src='/static/js/parameter_builder.js'></script>
    <link rel="stylesheet" href="/static/css/upload_results.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="/static/css/parameters.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="/static/css/table.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="/static/css/multi_filter_list.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="/static/css/batch_widget.css" type="text/css" media="screen" />
{% endblock %}

{% block content %}

<script type="text/x-jquery-tmpl" id="widget_template" src="/static/js/batch_widget_tmpl.html">
<div class="ocr_batch" id="ocr_batch">
    <div class="batch" id="batch25">
        <div class="batch_controls">
            <div class="batch_header convert">
                <div class="batch_name">${fields.name}</div>
                <a href="/batch/transcript/25" class="transcript_link" title="View Transcript">View Transcripts</a>
                <a href="/batch/export_options/2525/" class="export_link" title="Export Batch Transcripts">Export</a>
            </div>
            <div class="progressbar_container">
                <span class="progressbar success">
                    <span class="progress" style="width: ${extras.estimate_progress}%; " title="${extras.estimate_progress}%"></span>
                </span>
            </div>
            <span class="page_info"></span>
            <a href="/batch/retry_errored/25/" class="ui-state-default ui-corner-all button_link ui-icon ui-icon-refresh retry_errored" title="Retry Errored Tasks"></a>
            <a href="/batch/retry/25/" class="ui-state-default ui-corner-all button_link ui-icon ui-icon-refresh retry_batch" title="Retry All Tasks"></a>
            <a href="/batch/retry/25/" class="ui-state-default ui-corner-all button_link ui-icon ui-icon-circle-close retry_batch" title="Abort Entire Batch"></a>
            <div class="filter_container" id="status_filter">
                <div class="toggle_button ui-state-default ui-corner-all">Filter Tasks</div>
                <div class="list_popup" style="display: none; ">
                    <div class="state_filter" checked="checked">
                        <label class="state_label" for="ALL">ALL</label>
                        <input type="checkbox" name="ALL" class="filter_none" checked="checked">
                    </div>
                    <div class="state_filter">
                        <label class="state_label" for="INIT">INIT</label>
                        <input type="checkbox" name="status_INIT" class="filter_type" />
                    </div>
                    <div class="state_filter">
                        <label class="state_label" for="PENDING">PENDING</label>
                        <input type="checkbox" name="status_PENDING" class="filter_type" />
                    </div>
                    <div class="state_filter">
                        <label class="state_label" for="RETRY">RETRY</label>
                        <input type="checkbox" name="status_RETRY" class="filter_type" />
                    </div>
                    <div class="state_filter">
                        <label class="state_label" for="STARTED">STARTED</label>
                        <input type="checkbox" name="status_STARTED" class="filter_type" />
                    </div>
                    <div class="state_filter">
                        <label class="state_label" for="SUCCESS">SUCCESS</label>
                        <input type="checkbox" name="status_SUCCESS" class="filter_type" />
                    </div>
                    <div class="state_filter">
                        <label class="state_label" for="FAILURE">FAILURE</label>
                        <input type="checkbox" name="status_FAILURE" class="filter_type" />
                    </div>
                    <div class="state_filter">
                        <label class="state_label" for="ABORTED">ABORTED</label>
                        <input type="checkbox" name="status_ABORTED" class="filter_type" />
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="tl_container">
        <div class="task_list" style="margin-right: 0px; ">
            {% templatetag openvariable %}each $item.rows{% templatetag closevariable %}
            <a class="batch_task" style="" id="task${fields.tasks[$index].pk}" index-data="${$index}" href="#task${fields.tasks[$index].pk}">
                ${fields.tasks[$index].fields.page_name}
            </a>
            {% templatetag openvariable %}/each{% templatetag closevariable %}
        </div>
    </div>
</div>
</script>

<div class="widget" id="sidebar">
    <div class="widget_header">Recent Batches</div>
    <div class="widget_content">
        <div id="sidebar_content">

        </div>
    </div>
</div>

<div class="widget" id="batchcontainer">
    <div class="widget_header">Batch</div>
    <div class="widget_content">
        {% include "batch/includes/show_batch.html" %}
    </div> 
</div>


{% if batch %}
    <form id="batch_form" action="{{request.path}}" >
        <input type="hidden" name="batch_id" value="{{batch.pk}}" id="batch_id" />
        <input type="hidden" name="batch_type" value="{{batch.task_type}}" id="batch_type" />
    </form>
{% endif %}

{% endblock %}
